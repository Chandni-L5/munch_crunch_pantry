document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("newsletter-banner"),t=document.getElementById("newsletter-body"),n=document.getElementById("newsletter-toggle"),s=(document.getElementById("newsletter-toggle-icon"),document.getElementById("newsletter-form")),a=document.getElementById("newsletter-email"),o=document.getElementById("newsletter-response"),r=document.getElementById("subscribe-btn");function l(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null}function d(e,t){o.style.display="block",o.className="",o.classList.add("alert",`alert-${t}`),o.textContent=e}e&&t&&n&&s&&a&&o&&(n.addEventListener("click",(()=>{const e="none"===t.style.display;t.style.display=e?"block":"none",n.setAttribute("aria-expanded",e),n.setAttribute("aria-label",e?"Collapse newsletter sign up form":"Expand newsletter sign up form"),n.querySelector("i").style.transform=e?"rotate(0deg)":"rotate(-180deg)"})),s.addEventListener("submit",(async function(e){e.preventDefault();const t=a.value.trim();if(!t)return void d("Please enter a valid email address.","danger");const n=s.dataset.url;r.disabled=!0;try{const e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":l("csrftoken")},body:JSON.stringify({email:t})}),s=await e.json();if(!e.ok)return d(s.error||"Something went wrong. Please try again.","danger"),void(r.disabled=!1);d(s.message||"ðŸŽ‰ Thank you for subscribing!","success"),a.value="",r.disabled=!1}catch(e){d("Network error â€” please try again.","danger"),r.disabled=!1}})))}));